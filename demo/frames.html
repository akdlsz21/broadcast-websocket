<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BWS Iframe Demo</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 20px; }
      .row { display: flex; gap: 16px; }
      iframe { width: 48%; height: 420px; border: 1px solid #ccc; border-radius: 8px; }
      .note { margin: 12px 0; color: #444; }
      code { background: #f2f2f2; padding: 2px 4px; border-radius: 4px; }
      label { display: inline-block; margin-right: 8px; }
    </style>
  </head>
  <body>
    <h1>BroadcastWebsocket â€” Iframe Demo</h1>
    <p class="note">
      This page embeds two same-origin iframes, each running its own client instance.
      Only one becomes leader and opens the WebSocket. Followers delegate sends via BroadcastChannel
      and receive broadcasts of inbound messages. Start the local server:
      <code>npm run demo:server</code> (ws://localhost:8787).
    </p>

    <div style="margin-bottom: 10px;">
  <label>Server URL: <input id="wsurl" value="ws://localhost:8787" style="width: 280px;" /></label>
      <button id="reload">Reload Frames</button>
    </div>

    <div class="row">
      <iframe id="frameA"></iframe>
      <iframe id="frameB"></iframe>
    </div>

    <script>
      function load() {
        const url = document.getElementById('wsurl').value;
        document.getElementById('frameA').src = `./pane.html?name=A&url=${encodeURIComponent(url)}`;
        document.getElementById('frameB').src = `./pane.html?name=B&url=${encodeURIComponent(url)}`;
      }
      document.getElementById('reload').addEventListener('click', load);
      document.getElementById('wsurl').addEventListener('keydown', (e) => {
        if (e.key === 'Enter') { e.preventDefault(); load(); }
      });
      load();
    </script>
  </body>
  </html>

